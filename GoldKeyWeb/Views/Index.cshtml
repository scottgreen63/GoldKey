@*@model IEnumerable<GoldKeyLib.Entities.CustomerServicePackage>*@
@model IEnumerable<GoldKeyLib.Entities.CustomerServicePackage>
<p>
    @Html.ActionLink("Create New", "Create")
</p>





@{
    ViewBag.Title = "Displaying Data In Nested Grid View In MVC5";
    WebGrid grid = new WebGrid(source: Model, canSort: false);
    }
07.
08.
<style>
    #gridT, #gridT tr {
        border: 1px solid #0D857B;
        
    }

     #nestedT, #nestedT tr {
        border: 1px solid #f3f3f3;
        
    }

    #nestedT {
        margin: 0px 0px 0px 10px;
        padding: 5px;
        width: 95%;
        
    }

    #nestedT th {
        font-size: 14px;
        font-weight: bold;
        background-color: green;
        
    }

    .recordHoverEffect {
        cursor: pointer;
        
    }

    .recordHoverEffect:hover {
        background-color: rgb(248, 242, 242);
        
    }

    .expandRecordRecord {
        background-image: url(/Images/ShowHideImage.png);
        background-position-x: -22px;
        background-repeat: no-repeat;
        
    }

    .collapseRecordRecord {
        background-image: url(/Images/ShowHideImage.png);
        background-position-x: -2px;
        background-repeat: no-repeat;
        
    }


</style>
@section Scripts{

    <script>

        $(document).ready(function () {
            var size = $("#main #gridT > thead > tr >th").size();
            $("#main #gridT > thead > tr >th").last().remove();
            $("#main #gridT > thead > tr").prepend("<th></th>");
            $("#main #gridT > tbody > tr").each(function (i, el) {
                $(this).prepend(
                        $("<td></td>")
                        .addClass("expandRecord")
                        .addClass("recordHoverEffect")
                       .attr('title', "Show Hide Details")
                    );


                var table = $("table", this).parent().html();

                $(this).after("<tr><td></td><td style='padding:5px; margin:0px;' colspan='" + (size - 1) + "'>" + table + "</td></tr>");
                $("table", this).parent().remove();

                $(".recordHoverEffect", this).live("click", function () {
                    $(this).parent().closest("tr").next().slideToggle(100);
                    $(this).toggleClass("expandRecord collapseRecord");
                });
            });


            $("#main #gridT > tbody > tr td.expandRecord").each(function (i, el) {
                $(this).toggleClass("expandRecord collapseRecord");
                $(this).parent().closest("tr").next().slideToggle(100);
            });

        });
    </script>
    }
<div id="main" style="padding: 25px; background-color: yellow;">
@grid.GetHtml(
htmlAttributes: new { id = "gridT", width = "900px", style = "background-color:skyblue; color:blue; font-size:14pt; font-family:TimesNewRoman;" },
columns: grid.Columns(
grid.Column("CustomerServicePackage.ServicePackageID", " ID"),
grid.Column("CustomerServicePackage.ServicePackageName", " Name"),
grid.Column("CustomerServicePackage.ServicePackageFee", "Fee"),
grid.Column(format: (item) =>
                        {
        WebGrid subGrid = new WebGrid(source: item.CustomerServicePackageDetail);
                                    return subGrid.GetHtml(
        htmlAttributes: new { id = "nestedT", style = "background-color:red; color:white; font-size:12pt; font-family:verdana;" },
        columns: subGrid.Columns(
        subGrid.Column("ServiceID", " Service ID"),
        subGrid.Column("ServiceStartDateTime", "Start"),
        subGrid.Column("ServiceFinishDateTime", "Finish"),
        subGrid.Column("ServiceStatus", "Status"))
        );
        })
)
)
</div>
